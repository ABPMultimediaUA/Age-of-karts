//Especificar version de Opengl a utilizar
#version 330
 
//Recoger los datos de los vertices en los buffers correctamente (segun orden de envio en el programa)
layout (location = 0) in vec3 aVertex; //Vertices
layout (location = 1) in vec2 aCoords; //Vertices
layout (location = 2) in vec4 aPos; //Posicion y tamanyo

//Variables de salida al Fragment shader
out vec2 textCoords;

//Uniforms
uniform mat4 vp; //Matriz view-projection
uniform vec3 camRight; //Vector derecha de la camara
uniform vec3 camUp; //Vector arriba de la camara
 
void main() {
    vec3 particlePosition = aPos.xyz;

    //Pasamos las coordenadas de textura al fragment shader
    textCoords = aCoords;

    //Las particulas se modifican en funcion de la distancia
    vec3 pos = particlePosition + camRight * aVertex.x *aPos.w + camUp * aVertex.y * aPos.w;
    //Calculamos la posicion final del billboard en la pantalla a partir de la matriz view-projection
    gl_Position = vp * vec4(pos, 1.0);

}